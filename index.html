<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>VPN Auto Import</title>
    <script>
        (function() {
            let subscriptionUrl = null;
            
            // === 1. –ü—Ä–æ–±—É–µ–º –ø–æ–ª—É—á–∏—Ç—å –∏–∑ –ü–ê–†–ê–ú–ï–¢–†–û–í (?key=...) ===
            try {
                const urlParams = new URLSearchParams(window.location.search);
                const key = urlParams.get('key');
                if (key) {
                    let b64 = key.replace(/_/g, '/').replace(/-/g, '+');
                    while (b64.length % 4) b64 += '=';
                    subscriptionUrl = atob(b64);
                }
            } catch(e) {}
            
            // === 2. –ü—Ä–æ–±—É–µ–º –ø–æ–ª—É—á–∏—Ç—å –∏–∑ –•–ï–®–ê (#config=...) ===
            if (!subscriptionUrl && window.location.hash) {
                try {
                    const hash = window.location.hash.substring(1);
                    if (hash.startsWith('config=')) {
                        let b64 = hash.replace('config=', '');
                        b64 = b64.replace(/_/g, '/').replace(/-/g, '+');
                        while (b64.length % 4) b64 += '=';
                        const config = JSON.parse(atob(b64));
                        subscriptionUrl = config.sub;
                    }
                } catch(e) {}
            }
            
            // === 3. –ï—Å–ª–∏ –Ω–∞—à–ª–∏ —Å—Å—ã–ª–∫—É ‚Äî –î–û–ë–ê–í–õ–Ø–ï–ú happ://add/ –ü–ï–†–ï–î –†–ï–î–ò–†–ï–ö–¢–û–ú ===
            if (subscriptionUrl) {
                // –í–ê–ñ–ù–û: happ://add/ –¥–æ–±–∞–≤–ª—è–µ–º –ó–î–ï–°–¨, –∞ –Ω–µ –≤ –ø–∞—Ä–∞–º–µ—Ç—Ä–µ!
                window.location.href = `happ://add/${subscriptionUrl}`;
            } else {
                document.body.innerHTML = '<h2>‚ùå –ù–µ—Ç —Å—Å—ã–ª–∫–∏</h2><p>–ò—Å–ø–æ–ª—å–∑—É–π –≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä</p>';
            }
        })();
    </script>
</head>
<body>
    <p>üîÑ –ü–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ...</p>
</body>
</html>
